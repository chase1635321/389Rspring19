# Writeup 3 - Operational Security and Social Engineering

Name: Chase Kanipe
Section: 0201

I pledge on my honor that I have not given or received any unauthorized assistance on this assignment or examniation.

Digital acknowledgement: Chase Kanipe

## Assignment Writeup

### Part 1 (40 pts)

To complete this part of the assignment I first used netcat to connect to the server, then in response to the server request for a domain or IP to look up for the dig command, I gave it `### && <the command I wanted to run>`. I then searched around the directories using the cd command until I found the `flag.txt` in the  `/home` directory. To get the flag I then used `slkdfj && cat /home/flag.txt`. The flag that I found is CMSC389R-{d1gging_f0r_flag5_thr0ugh_1njec7ion}. The thought process for performing this injection was essentially thinking that it wasn't filtering for stringing different commands together. There are various ways she could protect against this. The most obvious, but not the most effective, would be to filter out any && or ; characters. However, it is possible the attacker might find an exception to a character blacklist. Another option is to downgrade the user permissions so the user only has access to the dig command. This would mean that any attacker attempts to run other commands would fail due to a permission error. Another option is to filter the input with a regular expression corresponding to a URL or IP format. For example, a python regular expression that will match only valid IP addresses is `\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.` Any user that violates this rule repeatedly could be warned and then eventually banned as this action pattern is similar to what an attacker might perform. This is more effective than a standard character blacklist, as it would be extremely difficult to find a command that could be used maliciously that also fit the format of the regular expression. As usual, however, the most effective mitigation is to use a combination of these various strategies, to ensure that even if the attacker finds a vulnerability in one, they are still blocked by the other defenses.

*Was a 300 word writeup really necessary? The hack itself  took maybe 5 seconds to perform.*


### Part 2 (60 pts)

The provided script interfaces with the command injection vulnerability in the server so that an attacker can more easily execute commands on the server. The first step for the script to accomplish this is for it to connect to the server using a socket connection. This socket connection enables the attacker to send specific commands to the server later. The user then has the option of selecting from the possible script commands, including: shell, pull, help, and quit. The shell command drops into a shell so that the user can perform functions like changing directories. The help command lists the possible commands and what they do, which can assist the attacker with narrowing further attack vectors based on the limitations of the tool they are using. The pull command pulls a file from the target machine to the local file system. This command works by running the cat command on the selected file, receiving the raw text over the sockets, and finally writing this data to the file that the user specifies in his/her command.  Finally, the quit command exits the program. These commands create a simple interface so that the attacker can more easily perform post exploitation and further recon tasks on the server. 

*Writing this one hurt my soul*
